2025-04-06 23:28:27,803 - gpt_handler - ERROR - GEMINI_API_KEY environment variable not set
2025-04-06 23:30:28,963 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-06 23:30:30,029 - vision - INFO - Successfully initialized Vision API client
2025-04-06 23:30:30,030 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-06 23:30:31,927 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-06 23:30:33,039 - vision - INFO - Successfully initialized Vision API client
2025-04-06 23:30:33,040 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-06 23:30:34,455 - vision - INFO - Successfully initialized Vision API client
2025-04-06 23:30:34,456 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:08:54,965 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-07 00:08:56,550 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:08:56,550 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:08:58,617 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-07 00:08:59,770 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:08:59,770 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:09:01,095 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:09:01,095 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:15:37,370 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-07 00:15:39,647 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:15:39,647 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:15:41,471 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-07 00:15:42,883 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:15:42,883 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:15:44,167 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:15:44,168 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:23:23,792 - main - WARNING - No user ID provided in request
2025-04-07 00:23:23,794 - main - INFO - Starting product scan for user: anonymous
2025-04-07 00:23:23,795 - main - INFO - Processing image with Vision API
2025-04-07 00:23:23,795 - vision - INFO - Starting product image analysis
2025-04-07 00:23:23,795 - vision - INFO - Preprocessing image before text detection
2025-04-07 00:23:23,961 - vision - INFO - Sending request to Vision API for text detection
2025-04-07 00:23:24,687 - vision - INFO - Successfully detected 149 text blocks
2025-04-07 00:23:24,688 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-07 00:23:25,232 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-07 00:23:25,233 - vision - INFO - Successfully parsed nutrition facts
2025-04-07 00:23:25,234 - vision - INFO - Successfully completed product image analysis
2025-04-07 00:23:25,234 - main - INFO - Extracted product name from image: Sprite
2025-04-07 00:23:25,234 - main - INFO - Analyzing nutrition data with Gemini
2025-04-07 00:23:25,234 - gpt_handler - INFO - Starting nutrition analysis for product: Sprite
2025-04-07 00:23:25,234 - gpt_handler - INFO - Sending request to Gemini API
2025-04-07 00:23:25,235 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-07 00:23:29,958 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-07 00:23:29,962 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-07 00:23:29,962 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-07 00:23:29,963 - gpt_handler - INFO - Generated visual verdict with health score: 3
2025-04-07 00:23:29,963 - main - INFO - Successfully completed product scan and analysis
2025-04-07 00:36:26,470 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-07 00:36:28,444 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:36:28,444 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:36:30,613 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-07 00:36:31,816 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:36:31,816 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:36:33,199 - vision - INFO - Successfully initialized Vision API client
2025-04-07 00:36:33,200 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-07 00:38:47,911 - main - WARNING - No user ID provided in request
2025-04-07 00:38:47,912 - main - INFO - Starting product scan for user: anonymous
2025-04-07 00:38:47,913 - main - INFO - Processing image with Vision API
2025-04-07 00:38:47,913 - vision - INFO - Starting product image analysis
2025-04-07 00:38:47,913 - vision - INFO - Preprocessing image before text detection
2025-04-07 00:38:47,991 - vision - INFO - Sending request to Vision API for text detection
2025-04-07 00:38:48,444 - vision - INFO - Successfully detected 37 text blocks
2025-04-07 00:38:48,445 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-07 00:38:48,849 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-07 00:38:48,850 - vision - INFO - Successfully parsed nutrition facts
2025-04-07 00:38:48,851 - vision - INFO - Successfully completed product image analysis
2025-04-07 00:38:48,851 - main - INFO - Extracted product name from image: Simply
2025-04-07 00:38:48,851 - main - INFO - Analyzing nutrition data with Gemini
2025-04-07 00:38:48,852 - gpt_handler - INFO - Starting nutrition analysis for product: Simply
2025-04-07 00:38:48,852 - gpt_handler - INFO - Sending request to Gemini API
2025-04-07 00:38:48,852 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-07 00:38:52,141 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-07 00:38:52,146 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-07 00:38:52,148 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-07 00:38:52,148 - gpt_handler - INFO - Generated visual verdict with health score: 5
2025-04-07 00:38:52,148 - main - INFO - Successfully completed product scan and analysis
2025-04-07 00:40:23,512 - main - WARNING - No user ID provided in request
2025-04-07 00:40:23,512 - main - INFO - Starting product scan for user: anonymous
2025-04-07 00:40:23,513 - main - INFO - Processing image with Vision API
2025-04-07 00:40:23,518 - vision - INFO - Starting product image analysis
2025-04-07 00:40:23,518 - vision - INFO - Preprocessing image before text detection
2025-04-07 00:40:23,546 - vision - INFO - Sending request to Vision API for text detection
2025-04-07 00:40:23,784 - vision - INFO - Successfully detected 7 text blocks
2025-04-07 00:40:23,785 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-07 00:40:24,209 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-07 00:40:24,209 - vision - INFO - Successfully parsed nutrition facts
2025-04-07 00:40:24,210 - vision - INFO - Successfully completed product image analysis
2025-04-07 00:40:24,210 - main - INFO - Extracted product name from image: Nutrition
2025-04-07 00:40:24,210 - main - INFO - Analyzing nutrition data with Gemini
2025-04-07 00:40:24,210 - gpt_handler - INFO - Starting nutrition analysis for product: Nutrition
2025-04-07 00:40:24,210 - gpt_handler - INFO - Sending request to Gemini API
2025-04-07 00:40:24,211 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-07 00:40:26,208 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-07 00:40:26,210 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-07 00:40:26,210 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-07 00:40:26,210 - gpt_handler - INFO - Generated visual verdict with health score: 5
2025-04-07 00:40:26,210 - main - INFO - Successfully completed product scan and analysis
2025-04-07 00:43:26,734 - main - WARNING - No user ID provided in request
2025-04-07 00:43:26,735 - main - INFO - Starting product scan for user: anonymous
2025-04-07 00:43:26,735 - main - INFO - Processing image with Vision API
2025-04-07 00:43:26,736 - vision - INFO - Starting product image analysis
2025-04-07 00:43:26,736 - vision - INFO - Preprocessing image before text detection
2025-04-07 00:43:26,766 - vision - INFO - Sending request to Vision API for text detection
2025-04-07 00:43:26,982 - vision - INFO - Successfully detected 6 text blocks
2025-04-07 00:43:26,983 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-07 00:43:27,409 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-07 00:43:27,410 - vision - INFO - Successfully parsed nutrition facts
2025-04-07 00:43:27,410 - vision - INFO - Successfully completed product image analysis
2025-04-07 00:43:27,411 - main - INFO - Extracted product name from image: AK
2025-04-07 00:43:27,411 - main - INFO - Analyzing nutrition data with Gemini
2025-04-07 00:43:27,411 - gpt_handler - INFO - Starting nutrition analysis for product: AK
2025-04-07 00:43:27,411 - gpt_handler - INFO - Sending request to Gemini API
2025-04-07 00:43:27,411 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-07 00:43:29,369 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-07 00:43:29,370 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-07 00:43:29,370 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-07 00:43:29,370 - gpt_handler - INFO - Generated visual verdict with health score: 2
2025-04-07 00:43:29,370 - main - INFO - Successfully completed product scan and analysis
2025-04-07 00:44:09,264 - main - WARNING - No user ID provided in request
2025-04-07 00:44:09,264 - main - INFO - Starting product scan for user: anonymous
2025-04-07 00:44:09,266 - main - INFO - Processing image with Vision API
2025-04-07 00:44:09,266 - vision - INFO - Starting product image analysis
2025-04-07 00:44:09,266 - vision - INFO - Preprocessing image before text detection
2025-04-07 00:44:09,293 - vision - INFO - Sending request to Vision API for text detection
2025-04-07 00:44:09,539 - vision - INFO - Successfully detected 13 text blocks
2025-04-07 00:44:09,540 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-07 00:44:09,935 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-07 00:44:09,936 - vision - INFO - Successfully parsed nutrition facts
2025-04-07 00:44:09,936 - vision - INFO - Successfully completed product image analysis
2025-04-07 00:44:09,937 - main - INFO - Extracted product name from image: JAK
2025-04-07 00:44:09,937 - main - INFO - Analyzing nutrition data with Gemini
2025-04-07 00:44:09,937 - gpt_handler - INFO - Starting nutrition analysis for product: JAK
2025-04-07 00:44:09,937 - gpt_handler - INFO - Sending request to Gemini API
2025-04-07 00:44:09,937 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-07 00:44:12,022 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-07 00:44:12,024 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-07 00:44:12,024 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-07 00:44:12,025 - gpt_handler - INFO - Generated visual verdict with health score: 3
2025-04-07 00:44:12,025 - main - INFO - Successfully completed product scan and analysis
2025-04-08 13:36:27,845 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-08 13:36:31,112 - vision - INFO - Successfully initialized Vision API client
2025-04-08 13:36:31,112 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-08 13:36:33,056 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-08 13:36:34,295 - vision - INFO - Successfully initialized Vision API client
2025-04-08 13:36:34,296 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-08 13:36:35,696 - vision - INFO - Successfully initialized Vision API client
2025-04-08 13:36:35,697 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-08 13:37:45,535 - main - WARNING - No user ID provided in request
2025-04-08 13:37:45,536 - main - INFO - Starting product scan for user: anonymous
2025-04-08 13:37:45,537 - main - INFO - Processing image with Vision API
2025-04-08 13:37:45,537 - vision - INFO - Starting product image analysis
2025-04-08 13:37:45,537 - vision - INFO - Preprocessing image before text detection
2025-04-08 13:37:45,774 - vision - INFO - Sending request to Vision API for text detection
2025-04-08 13:37:46,286 - vision - INFO - Successfully detected 66 text blocks
2025-04-08 13:37:46,287 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-08 13:37:46,793 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-08 13:37:46,796 - vision - INFO - Successfully parsed nutrition facts
2025-04-08 13:37:46,796 - vision - INFO - Successfully completed product image analysis
2025-04-08 13:37:46,796 - main - INFO - Extracted product name from image: Nutrition
2025-04-08 13:37:46,796 - main - INFO - Analyzing nutrition data with Gemini
2025-04-08 13:37:46,797 - gpt_handler - INFO - Starting nutrition analysis for product: Nutrition
2025-04-08 13:37:46,797 - gpt_handler - INFO - Sending request to Gemini API
2025-04-08 13:37:46,797 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-08 13:37:50,726 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-08 13:37:50,737 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-08 13:37:50,737 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-08 13:37:50,738 - gpt_handler - INFO - Generated visual verdict with health score: 5
2025-04-08 13:37:50,738 - main - INFO - Successfully completed product scan and analysis
2025-04-08 13:39:00,918 - main - WARNING - No user ID provided in request
2025-04-08 13:39:00,919 - main - INFO - Starting product scan for user: anonymous
2025-04-08 13:39:00,919 - main - INFO - Processing image with Vision API
2025-04-08 13:39:00,920 - vision - INFO - Starting product image analysis
2025-04-08 13:39:00,920 - vision - INFO - Preprocessing image before text detection
2025-04-08 13:39:00,946 - vision - INFO - Sending request to Vision API for text detection
2025-04-08 13:39:01,239 - vision - INFO - Successfully detected 124 text blocks
2025-04-08 13:39:01,240 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-08 13:39:01,858 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-08 13:39:01,859 - vision - INFO - Successfully parsed nutrition facts
2025-04-08 13:39:01,859 - vision - INFO - Successfully completed product image analysis
2025-04-08 13:39:01,859 - main - INFO - Extracted product name from image: Nutrition
2025-04-08 13:39:01,859 - main - INFO - Analyzing nutrition data with Gemini
2025-04-08 13:39:01,859 - gpt_handler - INFO - Starting nutrition analysis for product: Nutrition
2025-04-08 13:39:01,860 - gpt_handler - INFO - Sending request to Gemini API
2025-04-08 13:39:01,860 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-08 13:39:04,202 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-08 13:39:04,203 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-08 13:39:04,205 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-08 13:39:04,205 - gpt_handler - INFO - Generated visual verdict with health score: 4
2025-04-08 13:39:04,205 - main - INFO - Successfully completed product scan and analysis
2025-04-08 14:39:14,317 - main - WARNING - No user ID provided in request
2025-04-08 14:39:14,317 - main - INFO - Starting product scan for user: anonymous
2025-04-08 14:39:14,317 - main - INFO - Processing image with Vision API
2025-04-08 14:39:14,317 - vision - INFO - Starting product image analysis
2025-04-08 14:39:14,318 - vision - INFO - Preprocessing image before text detection
2025-04-08 14:39:14,420 - vision - INFO - Sending request to Vision API for text detection
2025-04-08 14:39:15,083 - vision - INFO - Successfully detected 149 text blocks
2025-04-08 14:39:15,084 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-08 14:39:15,733 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-08 14:39:15,733 - vision - INFO - Successfully parsed nutrition facts
2025-04-08 14:39:15,734 - vision - INFO - Successfully completed product image analysis
2025-04-08 14:39:15,734 - main - INFO - Extracted product name from image: Sprite
2025-04-08 14:39:15,734 - main - INFO - Analyzing nutrition data with Gemini
2025-04-08 14:39:15,734 - gpt_handler - INFO - Starting nutrition analysis for product: Sprite
2025-04-08 14:39:15,734 - gpt_handler - INFO - Sending request to Gemini API
2025-04-08 14:39:15,735 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-08 14:39:18,243 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-08 14:39:18,245 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-08 14:39:18,246 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-08 14:39:18,246 - gpt_handler - INFO - Generated visual verdict with health score: 3
2025-04-08 14:39:18,246 - main - INFO - Successfully completed product scan and analysis
2025-04-12 21:48:09,781 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-12 21:48:10,850 - vision - INFO - Successfully initialized Vision API client
2025-04-12 21:48:10,850 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-12 21:48:12,545 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-12 21:48:13,657 - vision - INFO - Successfully initialized Vision API client
2025-04-12 21:48:13,657 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-12 21:48:14,815 - vision - INFO - Successfully initialized Vision API client
2025-04-12 21:48:14,816 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-12 21:49:44,951 - main - WARNING - No user ID provided in request
2025-04-12 21:49:44,953 - main - INFO - Starting product scan for user: anonymous
2025-04-12 21:49:44,953 - main - INFO - Processing image with Vision API
2025-04-12 21:49:44,954 - vision - INFO - Starting product image analysis
2025-04-12 21:49:44,954 - vision - INFO - Preprocessing image before text detection
2025-04-12 21:49:45,315 - vision - INFO - Sending request to Vision API for text detection
2025-04-12 21:49:46,074 - vision - INFO - Successfully detected 193 text blocks
2025-04-12 21:49:46,075 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-12 21:49:46,824 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-12 21:49:46,824 - vision - ERROR - Error parsing nutrition facts: cannot access local variable 're' where it is not associated with a value
2025-04-12 21:49:46,826 - vision - ERROR - Traceback (most recent call last):
  File "C:\Users\yhung\Desktop\Career Path\Msc. Computer Science\Semester two\Term Projects\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\backend\app\vision.py", line 215, in _parse_nutrition_facts
    ingredients = [ing.strip() for ing in re.split(r'[,.]', ingredients_text) if ing.strip()]
                                          ^^
UnboundLocalError: cannot access local variable 're' where it is not associated with a value

2025-04-12 21:49:46,826 - vision - ERROR - Error in nutrition facts detection: cannot access local variable 're' where it is not associated with a value
2025-04-12 21:49:46,826 - vision - ERROR - Traceback (most recent call last):
  File "C:\Users\yhung\Desktop\Career Path\Msc. Computer Science\Semester two\Term Projects\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\backend\app\vision.py", line 143, in detect_nutrition_facts
    return self._parse_nutrition_facts(full_text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yhung\Desktop\Career Path\Msc. Computer Science\Semester two\Term Projects\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\backend\app\vision.py", line 215, in _parse_nutrition_facts
    ingredients = [ing.strip() for ing in re.split(r'[,.]', ingredients_text) if ing.strip()]
                                          ^^
UnboundLocalError: cannot access local variable 're' where it is not associated with a value

2025-04-12 21:49:46,827 - vision - ERROR - Error analyzing product image: cannot access local variable 're' where it is not associated with a value
2025-04-12 21:49:46,827 - vision - ERROR - Traceback (most recent call last):
  File "C:\Users\yhung\Desktop\Career Path\Msc. Computer Science\Semester two\Term Projects\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\backend\app\vision.py", line 244, in analyze_product_image
    nutrition = self.detect_nutrition_facts(image_bytes)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yhung\Desktop\Career Path\Msc. Computer Science\Semester two\Term Projects\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\backend\app\vision.py", line 143, in detect_nutrition_facts
    return self._parse_nutrition_facts(full_text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yhung\Desktop\Career Path\Msc. Computer Science\Semester two\Term Projects\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\EAT-GOOD-Your-AI-Powered-Smart-Eating-Assistant-main\backend\app\vision.py", line 215, in _parse_nutrition_facts
    ingredients = [ing.strip() for ing in re.split(r'[,.]', ingredients_text) if ing.strip()]
                                          ^^
UnboundLocalError: cannot access local variable 're' where it is not associated with a value

2025-04-12 21:49:46,828 - main - ERROR - Vision API error: Error analyzing product image: cannot access local variable 're' where it is not associated with a value
2025-04-12 21:51:51,438 - gpt_handler - INFO - Successfully initialized Gemini API client
2025-04-12 21:51:54,938 - vision - INFO - Successfully initialized Vision API client
2025-04-12 21:51:54,938 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-12 21:51:56,641 - vision - INFO - Successfully initialized Vision API client
2025-04-12 21:51:56,642 - gpt_handler - INFO - Initialized NutritionAnalyzer with model: gemini-2.0-flash
2025-04-12 21:51:56,731 - main - WARNING - No user ID provided in request
2025-04-12 21:51:56,731 - main - INFO - Starting product scan for user: anonymous
2025-04-12 21:51:56,732 - main - INFO - Processing image with Vision API
2025-04-12 21:51:56,732 - vision - INFO - Starting product image analysis
2025-04-12 21:51:56,732 - vision - INFO - Preprocessing image before text detection
2025-04-12 21:51:56,853 - vision - INFO - Sending request to Vision API for text detection
2025-04-12 21:51:57,545 - vision - INFO - Successfully detected 193 text blocks
2025-04-12 21:51:57,546 - vision - INFO - Sending request to Vision API for nutrition facts detection
2025-04-12 21:51:58,155 - vision - INFO - Successfully extracted text from nutrition facts
2025-04-12 21:51:58,156 - vision - INFO - Successfully parsed nutrition facts
2025-04-12 21:51:58,156 - vision - INFO - Successfully completed product image analysis
2025-04-12 21:51:58,156 - main - INFO - Extracted product name from image: FOR
2025-04-12 21:51:58,157 - main - INFO - Analyzing nutrition data with Gemini
2025-04-12 21:51:58,157 - gpt_handler - INFO - Starting nutrition analysis for product: FOR
2025-04-12 21:51:58,157 - gpt_handler - INFO - Sending request to Gemini API
2025-04-12 21:51:58,157 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-04-12 21:52:02,404 - httpx - INFO - HTTP Request: POST https://us-central1-aiplatform.googleapis.com/v1beta1/projects/eat-good-vsion/locations/us-central1/publishers/google/models/gemini-2.0-flash:generateContent "HTTP/1.1 200 OK"
2025-04-12 21:52:02,408 - google_genai.models - INFO - AFC remote call 1 is done.
2025-04-12 21:52:02,409 - gpt_handler - INFO - Successfully parsed Gemini response
2025-04-12 21:52:02,409 - gpt_handler - INFO - Generated visual verdict with health score: 4
2025-04-12 21:52:02,409 - main - INFO - Successfully completed product scan and analysis
